import{r as t,bB as e,bA as ue,bJ as Me}from"./vendor-c3fe08cd.js";import{G as y,u as L,r as Q,i as ie,g as ce,h as ze,R as Fe,V as Re,C as Oe,S as Ue,E as Ve,U as J,A as fe,a as $,j as Le,b as Qe,Q as We,c as qe,T as De,d as Ke,k as He}from"./index-24276f89.js";import{S,C as re,k as le,T as W,I as Ze,l as Je,D as $e}from"./fluentui-react-3f437ee8.js";import{h as Xe}from"./fluentui-icons-cc8a82c3.js";const Ye="_container_1btza_1",et="_chatRoot_1btza_15",tt="_chatContainer_1btza_25",st="_chatEmptyState_1btza_41",nt="_chatEmptyStateTitle_1btza_61",at="_chatEmptyStateSubtitle_1btza_75",ot="_chatMessageStream_1btza_107",it="_chatMessageGpt_1btza_131",ct="_chatMessageGptMinWidth_1btza_145",rt="_chatInput_1btza_155",lt="_chatAnalysisPanel_1btza_181",ut="_chatSettingsSeparator_1btza_197",ht="_loadingLogo_1btza_205",dt="_commandsContainer_1btza_213",pt="_commandButton_1btza_223",o={container:Ye,chatRoot:et,chatContainer:tt,chatEmptyState:st,chatEmptyStateTitle:nt,chatEmptyStateSubtitle:at,chatMessageStream:ot,chatMessageGpt:it,chatMessageGptMinWidth:ct,chatInput:rt,chatAnalysisPanel:lt,chatSettingsSeparator:ut,loadingLogo:ht,commandsContainer:dt,commandButton:pt},mt="_container_1142u_1",Ce={container:mt},gt=({updateGPT4VInputs:j,updateUseGPT4V:f,isUseGPT4V:C,gpt4vInputs:I})=>{const[x,E]=t.useState(C),[_,w]=t.useState(I||y.TextAndImages),k=(b,p)=>{f(!!p),E(!!p)},q=(b,p)=>{if(p){const T=p.key;j(T||y.TextAndImages),T&&w(T)}};return t.useEffect(()=>{x&&j(y.TextAndImages)},[x]),e.jsxs(S,{className:Ce.container,tokens:{childrenGap:10},children:[e.jsx(re,{checked:x,label:"Use GPT-4 Turbo with Vision",onChange:k}),x&&e.jsx(le,{selectedKey:_,className:Ce.oneshotSettingsSeparator,label:"GPT-4 Turbo with Vision Inputs",options:[{key:y.TextAndImages,text:"Images and text from index"},{text:"Images only",key:y.Images},{text:"Text only",key:y.Texts}],required:!0,onChange:q})]})},St="_evaluationContainer_1jfqt_1",xt="_evaluationInputTextContainer_1jfqt_11",vt="_evaluationInputContainer_1jfqt_25",ft="_evaluationInputTextArea_1jfqt_39",Ct="_evaluationInputButtonsContainer_1jfqt_49",u={evaluationContainer:St,evaluationInputTextContainer:xt,evaluationInputContainer:vt,evaluationInputTextArea:ft,evaluationInputButtonsContainer:Ct},_e=L?ue().instance:void 0,be={dropdown:{width:300}},_t=[{key:"ja",text:"Ja"},{key:"teils",text:"Teils"},{key:"nein",text:"Nein"},{key:"nicht beurteilbar",text:"Nicht beurteilbar"}],bt=[{key:"Zeitersparnis",text:"Zeitersparnis"},{key:"Inspiration / Input",text:"Inspiration / Input"},{key:"Sonstiges, siehe unten:",text:"Sonstiges, siehe unten:"}],Tt=({disabled:j,tabName:f})=>{const[C,I]=t.useState(!1),{instance:x}=ue();Q&&ie(x);const[E,_]=t.useState(""),[w,k]=t.useState([]),q=(h,a)=>{a?a.length<=1e3&&_(a):_("")},[b,p]=t.useState(""),T=(h,a)=>{a?a.length<=1e3&&p(a):p("")},[X,M]=t.useState(""),he=(h,a)=>{a?a.length<=5e3&&M(a):M("")},[A,D]=t.useState(""),Y=(h,a)=>{a?a.length<=1e3&&D(a):D("")},de=(h,a,F)=>{if(!a){console.log("Keine Auswahl!");return}const m=[...w];if(a.selected)m.push(a);else{const N=m.findIndex(r=>r.key===a.key);N!==-1&&m.splice(N,1)}k(m)},K=async()=>{const h=_e?await ce(_e):void 0,a=new Date,F=w.map(r=>r.text),m={TabName:f,Korrektheit:v?.text,korrekte_Antwort:b,Benefit:F,BenefitMinuten:X,Sonstiges:A,Benutzer:E,Zeitstempel:a,model:"gpt-4"},N=JSON.stringify(m)+`
`;try{const r=await ze(N,h)}catch(r){console.log(r)}finally{I(!0),_(""),D(""),p(""),k([]),z(void 0),setTimeout(()=>{I(!1)},6e3)}},[v,z]=t.useState();return e.jsxs("div",{children:[C&&e.jsx("div",{style:{position:"fixed",top:"10px",right:"10px",background:"#9CBF2B",padding:"10px",borderRadius:"5px",boxShadow:"0 0 10px rgba(0, 0, 0, 0.2)"},children:e.jsx("p",{children:"Gespeichert!"})}),e.jsxs(S,{className:u.evaluationContainer,children:[e.jsx(S,{horizontal:!0,className:u.evaluationInputContainer,children:e.jsx(le,{label:"Ist die Antwort inhaltlich korrekt?",selectedKey:v?v.key:void 0,onChange:(h,a,F)=>{z(a)},placeholder:"Wähle eine Option",options:_t,styles:be})}),(v?.text==="Nein"||v?.text==="Teils"||v?.text==="Nicht beurteilbar")&&e.jsx("div",{children:e.jsx(S,{horizontal:!0,className:u.evaluationInputTextContainer,children:e.jsx(W,{className:u.evaluationInputTextContainer,resizable:!1,placeholder:"Was hat nicht gepasst?",value:b,onChange:T})})}),e.jsx(S,{horizontal:!0,className:u.evaluationInputContainer,children:e.jsx(le,{label:"Was hat dir die Antwort gebracht?",selectedKeys:w?.map(h=>h.key.toString()),onChange:de,placeholder:"Wähle eine Option",options:bt,styles:be,multiSelect:!0})}),e.jsx(S,{horizontal:!0,className:u.evaluationInputTextContainer,children:e.jsx(W,{className:u.evaluationInputTextContainer,resizable:!1,placeholder:"Wieviel Zeitersparnis (in Minuten) hat dir Athena gebracht?",value:X,onChange:he})}),e.jsx(S,{horizontal:!0,className:u.evaluationInputTextContainer,children:e.jsx(W,{className:u.evaluationInputTextContainer,resizable:!1,placeholder:"Sonstiges: ",value:A,onChange:Y})}),e.jsx(S,{horizontal:!0,className:u.evaluationInputTextContainer,children:e.jsx(W,{className:u.evaluationInputTextContainer,resizable:!1,placeholder:"Bitte gib deinen Namen an: ",value:E,onChange:q})}),e.jsx(S,{horizontal:!0,className:u.evaluationInputButtonsContainer,children:e.jsx(Ze,{style:{color:"black",marginLeft:"10px"},iconProps:{iconName:"Save"},title:"Speichern",ariaLabel:"Speichern",onClick:()=>K()})})]})]})};function yt(){const[j,f]=t.useState(!1),[C,I]=t.useState(""),[x,E]=t.useState(0),[_,w]=t.useState(Fe.Hybrid),[k,q]=t.useState(!0),[b,p]=t.useState(!0),[T,X]=t.useState(!1),[M,he]=t.useState(""),[A,D]=t.useState(!1),[Y,de]=t.useState([Re.Embedding]),[K,v]=t.useState(!1),[z,h]=t.useState(!1),[a,F]=t.useState(y.TextAndImages),[m,N]=t.useState(!1),r=t.useRef(""),ee=t.useRef(null),[P,H]=t.useState(!1),[pe,te]=t.useState(!1),[R,se]=t.useState(),[me,ne]=t.useState(),[O,G]=t.useState(void 0),[U,ge]=t.useState(0),[l,Z]=t.useState([]),[Se,xe]=t.useState([]),[Te,ye]=t.useState(!1),je=async()=>{const s=B?await ce(B):void 0;Ke(s).then(n=>{ye(n.showGPT4VOptions)})},Ie=async(s,n,d,oe)=>{let g="",i={};const Ge=c=>new Promise(Be=>{setTimeout(()=>{g+=c;const Ee={...i,choices:[{...i.choices[0],message:{content:g,role:i.choices[0].message.role}}]};xe([...n,[s,Ee]]),Be(null)},33)});try{te(!0);for await(const c of Me(oe))if(c.choices&&c.choices[0].context&&c.choices[0].context.data_points)c.choices[0].message=c.choices[0].delta,i=c;else if(c.choices&&c.choices[0].delta.content)H(!1),await Ge(c.choices[0].delta.content);else if(c.choices&&c.choices[0].context)i.choices[0].context={...i.choices[0].context,...c.choices[0].context};else if(c.error)throw Error(c.error)}finally{te(!1)}return{...i,choices:[{...i.choices[0],message:{content:g,role:i.choices[0].message.role}}]}},B=L?ue().instance:void 0,V=async s=>{r.current=s,R&&se(void 0),H(!0),ne(void 0),G(void 0);const n=B?await ce(B):void 0;try{const oe={messages:[...l.flatMap(i=>[{content:i[0],role:"user"},{content:i[1].choices[0].message.content,role:"assistant"}]),{content:s,role:"user"}],stream:b,context:{overrides:{prompt_template:C.length===0?void 0:C,exclude_category:M.length===0?void 0:M,top:x,retrieval_mode:_,semantic_ranker:k,semantic_captions:T,suggest_followup_questions:A,use_oid_security_filter:K,use_groups_security_filter:z,vector_fields:Y,use_gpt4v:m,gpt4v_input:a}},session_state:l.length?l[l.length-1][1].choices[0].session_state:null},g=await He(oe,n);if(!g.body)throw Error("No response body");if(b){const i=await Ie(s,l,Z,g.body);Z([...l,[s,i]])}else{const i=await g.json();if(g.status>299||!g.ok)throw Error(i.error||"Unknown error");Z([...l,[s,i]])}}catch(d){se(d)}finally{H(!1)}},we=()=>{r.current="",R&&se(void 0),ne(void 0),G(void 0),Z([]),xe([]),H(!1),te(!1)};t.useEffect(()=>ee.current?.scrollIntoView({behavior:"smooth"}),[P]),t.useEffect(()=>ee.current?.scrollIntoView({behavior:"auto"}),[Se]),t.useEffect(()=>{je()},[]);const ke=(s,n)=>{I(n||"")},Ae=(s,n)=>{v(!!n)},Ne=(s,n)=>{h(!!n)},Pe=s=>{V(s)},ve=(s,n)=>{me===s&&O===$.CitationTab&&U===n?G(void 0):(ne(s),G($.CitationTab)),ge(n)},ae=(s,n)=>{G(O===s&&U===n?void 0:s),ge(n)};return e.jsxs("div",{className:o.container,children:[e.jsxs("div",{className:o.commandsContainer,children:[e.jsx(Oe,{className:o.commandButton,onClick:we,disabled:!r.current||P}),e.jsx(Ue,{className:o.commandButton,onClick:()=>f(!j)})]}),e.jsxs("div",{className:o.chatRoot,children:[e.jsxs("div",{className:o.chatContainer,children:[r.current?e.jsxs("div",{className:o.chatMessageStream,children:[pe&&Se.map((s,n)=>e.jsxs("div",{children:[e.jsx(J,{message:s[0]}),e.jsx("div",{className:o.chatMessageGpt,children:e.jsx(fe,{isStreaming:!0,answer:s[1],isSelected:!1,onCitationClicked:d=>ve(d,n),onThoughtProcessClicked:()=>ae($.ThoughtProcessTab,n),onFollowupQuestionClicked:d=>V(d),showFollowupQuestions:A&&l.length-1===n},n)})]},n)),!pe&&l.map((s,n)=>e.jsxs("div",{children:[e.jsx(J,{message:s[0]}),e.jsx("div",{className:o.chatMessageGpt,children:e.jsx(fe,{isStreaming:!1,answer:s[1],isSelected:U===n&&O!==void 0,onCitationClicked:d=>ve(d,n),onThoughtProcessClicked:()=>ae($.ThoughtProcessTab,n),onFollowupQuestionClicked:d=>V(d),showFollowupQuestions:A&&l.length-1===n},n)})]},n)),P&&e.jsxs(e.Fragment,{children:[e.jsx(J,{message:r.current}),e.jsx("div",{className:o.chatMessageGptMinWidth,children:e.jsx(Le,{})})]}),R?e.jsxs(e.Fragment,{children:[e.jsx(J,{message:r.current}),e.jsx("div",{className:o.chatMessageGptMinWidth,children:e.jsx(Qe,{error:R.toString(),onRetry:()=>V(r.current)})})]}):null,e.jsx("div",{ref:ee})]}):e.jsxs("div",{className:o.chatEmptyState,children:[e.jsx("h2",{children:"Athena KI-Testphase: Feedback zur Qualität im Teamskanal erwünscht!"}),e.jsx(Xe,{fontSize:"120px",primaryFill:"#9CBF2B","aria-hidden":"true","aria-label":"Chatgpt logo"}),e.jsx("h1",{className:o.chatEmptyStateTitle,children:"Chatte mit ChatGPT, ohne Verwendung der PCS Wissensdatenbank"}),e.jsx("h2",{className:o.chatEmptyStateSubtitle,children:"Hier zwei Beispiele:"}),e.jsx(Ve,{onExampleClicked:Pe,useGPT4V:m,tabName:"chatgptoriginal"})]}),e.jsx("div",{className:o.chatInput,children:e.jsx(We,{clearOnSend:!0,placeholder:"Gib eine neue Frage ein...",disabled:P,onSend:s=>V(s)})})]}),l.length>0&&O&&e.jsx(qe,{className:o.chatAnalysisPanel,activeCitation:me,onActiveTabChanged:s=>ae(s,U),citationHeight:"810px",answer:l[U][1],activeTab:O}),e.jsxs(Je,{headerText:"Konfigurieren Sie die Erstellung von Antworten",isOpen:j,isBlocking:!1,onDismiss:()=>f(!1),closeButtonAriaLabel:"Schließen",onRenderFooterContent:()=>e.jsx($e,{onClick:()=>f(!1),children:"Close"}),isFooterAtBottom:!0,children:[e.jsx(W,{className:o.chatSettingsSeparator,defaultValue:C,label:"Prompt Vorlage überschreiben",multiline:!0,autoAdjustHeight:!0,onChange:ke}),Te&&e.jsx(gt,{gpt4vInputs:a,isUseGPT4V:m,updateUseGPT4V:s=>{N(s)},updateGPT4VInputs:s=>F(s)}),L&&e.jsx(re,{className:o.chatSettingsSeparator,checked:K||Q,label:"Oid-Sicherheitsfilter verwenden",disabled:!ie(B)||Q,onChange:Ae}),L&&e.jsx(re,{className:o.chatSettingsSeparator,checked:z||Q,label:"Gruppen Sicherheitsfilter verwendenr",disabled:!ie(B)||Q,onChange:Ne}),L&&e.jsx(De,{})]})]}),r.current?e.jsx("div",{className:o.emailBottomSection,children:e.jsx("div",{className:o.emailQuestionInput,children:!P&&!R&&e.jsx(Tt,{disabled:P,tabName:"chatGPT"})})}):e.jsx("div",{})]})}yt.displayName="Chatgpt";export{yt as Component};
//# sourceMappingURL=Chatgpt-95d8ce74.js.map
